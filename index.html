<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>èªéŸ³è¾¨è­˜å¾ªç’°ï¼ˆå«æç¤ºéŸ³èˆ‡éŒ„éŸ³æç¤ºï¼‰</title>
<style>
body {
  font-family: 'Segoe UI', sans-serif;
  text-align: center;
  background: #0b1220;
  color: white;
  margin: 0;
  padding-top: 60px;
}
button {
  background: #6366f1;
  color: white;
  border: none;
  padding: 12px 25px;
  border-radius: 8px;
  font-size: 18px;
  cursor: pointer;
}
#text {
  margin-top: 30px;
  font-size: 22px;
  min-height: 40px;
}
#indicator {
  width: 20px;
  height: 20px;
  margin: 20px auto;
  border-radius: 50%;
  background: gray;
  box-shadow: 0 0 10px gray;
  transition: background 0.3s;
}
@keyframes blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.2; }
}
.recording {
  background: #ef4444 !important;
  box-shadow: 0 0 15px #ef4444;
  animation: blink 1s infinite;
}
</style>
</head>
<body>
<h2>ğŸ¤ ä¸­æ–‡èªéŸ³è¾¨è­˜ + è‡ªå‹•æœ—è®€å¾ªç’°</h2>
<button id="startBtn">é–‹å§‹</button>
<div id="indicator"></div>
<div id="text"></div>

<audio id="beep" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" preload="auto"></audio>

<script>
const startBtn = document.getElementById('startBtn');
const textDiv = document.getElementById('text');
const beep = document.getElementById('beep');
const indicator = document.getElementById('indicator');
const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
const recognition = new SpeechRecognition();

recognition.lang = 'zh-TW'; // âœ… ä¸­æ–‡è¾¨è­˜
recognition.continuous = false;
recognition.interimResults = false;

// æ’­æ”¾æç¤ºéŸ³å¾Œé–‹å§‹éŒ„éŸ³
function playBeepAndStart() {
  indicator.classList.remove('recording'); // é—œé–‰é–ƒçˆ
  beep.play();
  beep.onended = () => {
    indicator.classList.add('recording'); // é–‹å§‹é–ƒçˆï¼Œè¡¨ç¤ºæ­£åœ¨éŒ„éŸ³
    recognition.start();
  };
}

recognition.onresult = e => {
  const text = e.results[0][0].transcript;
  textDiv.textContent = 'è¾¨è­˜çµæœï¼š' + text;

  // åœæ­¢é–ƒçˆ
  indicator.classList.remove('recording');

  // âœ… è‡ªå‹•æœ—è®€
  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = 'zh-TW';
  speechSynthesis.speak(utter);

  // âœ… æœ—è®€å®Œ 1 ç§’å¾Œå†æ’­æ”¾æç¤ºéŸ³
  utter.onend = () => setTimeout(playBeepAndStart, 1000);
};

recognition.onerror = e => {
  console.log('éŒ¯èª¤ï¼š', e.error);
  indicator.classList.remove('recording');
  setTimeout(playBeepAndStart, 1000);
};

startBtn.onclick = () => {
  startBtn.disabled = true;
  startBtn.textContent = 'é‹ä½œä¸­...';
  playBeepAndStart();
};
</script>
</body>
</html>
