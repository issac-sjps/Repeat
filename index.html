<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>中文語音辨識測試</title>
<style>
body { font-family: sans-serif; text-align: center; margin-top: 50px; }
button { padding: 10px 20px; font-size: 16px; }
#text { margin-top: 20px; font-size: 20px; }
</style>
</head>
<body>
<h2>🎤 中文語音辨識 + 自動朗讀</h2>
<button id="startBtn">開始錄音</button>
<div id="text"></div>

<script>
const startBtn = document.getElementById('startBtn');
const textDiv = document.getElementById('text');
const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
const recognition = new SpeechRecognition();

recognition.lang = 'zh-TW'; // ✅ 中文辨識
recognition.continuous = false;
recognition.interimResults = false;

recognition.onresult = e => {
  const text = e.results[0][0].transcript;
  textDiv.textContent = '辨識結果：' + text;

  // ✅ 自動朗讀結果
  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = 'zh-TW';
  speechSynthesis.speak(utter);

  // ✅ 朗讀完 1 秒後再重新收音
  utter.onend = () => setTimeout(() => recognition.start(), 1000);
};

recognition.onerror = e => {
  console.log('錯誤：', e.error);
  setTimeout(() => recognition.start(), 1000);
};

startBtn.onclick = () => {
  recognition.start();
  startBtn.disabled = true;
  startBtn.textContent = '正在聽...';
};
</script>
</body>
</html>
